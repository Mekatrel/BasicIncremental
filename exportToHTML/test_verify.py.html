<html>
<head>
<title>test_verify.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #808080;}
.s1 { color: #a9b7c6;}
.s2 { color: #629755; font-style: italic;}
.s3 { color: #cc7832;}
.s4 { color: #6a8759;}
.s5 { color: #6897bb;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_verify.py</font>
</center></td></tr></table>
<pre><span class="s0">##############################################################################</span>
<span class="s0">#</span>
<span class="s0"># Copyright (c) 2001, 2002 Zope Foundation and Contributors.</span>
<span class="s0"># All Rights Reserved.</span>
<span class="s0">#</span>
<span class="s0"># This software is subject to the provisions of the Zope Public License,</span>
<span class="s0"># Version 2.1 (ZPL).  A copy of the ZPL should accompany this distribution.</span>
<span class="s0"># THIS SOFTWARE IS PROVIDED &quot;AS IS&quot; AND ANY AND ALL EXPRESS OR IMPLIED</span>
<span class="s0"># WARRANTIES ARE DISCLAIMED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED</span>
<span class="s0"># WARRANTIES OF TITLE, MERCHANTABILITY, AGAINST INFRINGEMENT, AND FITNESS</span>
<span class="s0"># FOR A PARTICULAR PURPOSE.</span>
<span class="s0">#</span>
<span class="s0">##############################################################################</span>
<span class="s2">&quot;&quot;&quot; zope.interface.verify unit tests 
&quot;&quot;&quot;</span>
<span class="s3">import </span><span class="s1">unittest</span>

<span class="s0"># pylint:disable=inherit-non-class,no-method-argument,no-self-argument</span>

<span class="s3">class </span><span class="s1">Test_verifyClass(unittest.TestCase):</span>

    <span class="s1">verifier = </span><span class="s3">None</span>

    <span class="s3">def </span><span class="s1">setUp(self):</span>
        <span class="s1">self.verifier = self._get_FUT()</span>

    <span class="s1">@classmethod</span>
    <span class="s3">def </span><span class="s1">_get_FUT(cls):</span>
        <span class="s3">from </span><span class="s1">zope.interface.verify </span><span class="s3">import </span><span class="s1">verifyClass</span>
        <span class="s3">return </span><span class="s1">verifyClass</span>

    <span class="s1">_adjust_object_before_verify = </span><span class="s3">lambda </span><span class="s1">self</span><span class="s3">, </span><span class="s1">x: x</span>

    <span class="s3">def </span><span class="s1">_callFUT(self</span><span class="s3">, </span><span class="s1">iface</span><span class="s3">, </span><span class="s1">klass</span><span class="s3">, </span><span class="s1">**kwargs):</span>
        <span class="s3">return </span><span class="s1">self.verifier(iface</span><span class="s3">,</span>
                             <span class="s1">self._adjust_object_before_verify(klass)</span><span class="s3">,</span>
                             <span class="s1">**kwargs)</span>

    <span class="s3">def </span><span class="s1">test_class_doesnt_implement(self):</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface.exceptions </span><span class="s3">import </span><span class="s1">DoesNotImplement</span>

        <span class="s3">class </span><span class="s1">ICurrent(Interface):</span>
            <span class="s3">pass</span>

        <span class="s3">class </span><span class="s1">Current(object):</span>
            <span class="s3">pass</span>

        <span class="s1">self.assertRaises(DoesNotImplement</span><span class="s3">, </span><span class="s1">self._callFUT</span><span class="s3">, </span><span class="s1">ICurrent</span><span class="s3">, </span><span class="s1">Current)</span>

    <span class="s3">def </span><span class="s1">test_class_doesnt_implement_but_classImplements_later(self):</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">classImplements</span>

        <span class="s3">class </span><span class="s1">ICurrent(Interface):</span>
            <span class="s3">pass</span>

        <span class="s3">class </span><span class="s1">Current(object):</span>
            <span class="s3">pass</span>

        <span class="s1">classImplements(Current</span><span class="s3">, </span><span class="s1">ICurrent)</span>

        <span class="s1">self._callFUT(ICurrent</span><span class="s3">, </span><span class="s1">Current)</span>

    <span class="s3">def </span><span class="s1">test_class_doesnt_have_required_method_simple(self):</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">implementer</span>
        <span class="s3">from </span><span class="s1">zope.interface.exceptions </span><span class="s3">import </span><span class="s1">BrokenImplementation</span>

        <span class="s3">class </span><span class="s1">ICurrent(Interface):</span>
            <span class="s3">def </span><span class="s1">method():</span>
                <span class="s2">&quot;&quot;&quot;docstring&quot;&quot;&quot;</span>

        <span class="s1">@implementer(ICurrent)</span>
        <span class="s3">class </span><span class="s1">Current(object):</span>
            <span class="s3">pass</span>

        <span class="s1">self.assertRaises(BrokenImplementation</span><span class="s3">,</span>
                          <span class="s1">self._callFUT</span><span class="s3">, </span><span class="s1">ICurrent</span><span class="s3">, </span><span class="s1">Current)</span>

    <span class="s3">def </span><span class="s1">test_class_has_required_method_simple(self):</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">implementer</span>

        <span class="s3">class </span><span class="s1">ICurrent(Interface):</span>
            <span class="s3">def </span><span class="s1">method():</span>
                <span class="s2">&quot;&quot;&quot;docstring&quot;&quot;&quot;</span>

        <span class="s1">@implementer(ICurrent)</span>
        <span class="s3">class </span><span class="s1">Current(object):</span>

            <span class="s3">def </span><span class="s1">method(self):</span>
                <span class="s3">raise </span><span class="s1">NotImplementedError()</span>

        <span class="s1">self._callFUT(ICurrent</span><span class="s3">, </span><span class="s1">Current)</span>

    <span class="s3">def </span><span class="s1">test_class_doesnt_have_required_method_derived(self):</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">implementer</span>
        <span class="s3">from </span><span class="s1">zope.interface.exceptions </span><span class="s3">import </span><span class="s1">BrokenImplementation</span>

        <span class="s3">class </span><span class="s1">IBase(Interface):</span>
            <span class="s3">def </span><span class="s1">method():</span>
                <span class="s2">&quot;&quot;&quot;docstring&quot;&quot;&quot;</span>

        <span class="s3">class </span><span class="s1">IDerived(IBase):</span>
            <span class="s3">pass</span>

        <span class="s1">@implementer(IDerived)</span>
        <span class="s3">class </span><span class="s1">Current(object):</span>
            <span class="s3">pass</span>

        <span class="s1">self.assertRaises(BrokenImplementation</span><span class="s3">,</span>
                          <span class="s1">self._callFUT</span><span class="s3">, </span><span class="s1">IDerived</span><span class="s3">, </span><span class="s1">Current)</span>

    <span class="s3">def </span><span class="s1">test_class_has_required_method_derived(self):</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">implementer</span>

        <span class="s3">class </span><span class="s1">IBase(Interface):</span>
            <span class="s3">def </span><span class="s1">method():</span>
                <span class="s2">&quot;&quot;&quot;docstring&quot;&quot;&quot;</span>

        <span class="s3">class </span><span class="s1">IDerived(IBase):</span>
            <span class="s3">pass</span>

        <span class="s1">@implementer(IDerived)</span>
        <span class="s3">class </span><span class="s1">Current(object):</span>

            <span class="s3">def </span><span class="s1">method(self):</span>
                <span class="s3">raise </span><span class="s1">NotImplementedError()</span>

        <span class="s1">self._callFUT(IDerived</span><span class="s3">, </span><span class="s1">Current)</span>

    <span class="s3">def </span><span class="s1">test_method_takes_wrong_arg_names_but_OK(self):</span>
        <span class="s0"># We no longer require names to match.</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">implementer</span>

        <span class="s3">class </span><span class="s1">ICurrent(Interface):</span>

            <span class="s3">def </span><span class="s1">method(a):</span>
                <span class="s2">&quot;&quot;&quot;docstring&quot;&quot;&quot;</span>

        <span class="s1">@implementer(ICurrent)</span>
        <span class="s3">class </span><span class="s1">Current(object):</span>

            <span class="s3">def </span><span class="s1">method(self</span><span class="s3">, </span><span class="s1">b):</span>
                <span class="s3">raise </span><span class="s1">NotImplementedError()</span>

        <span class="s1">self._callFUT(ICurrent</span><span class="s3">, </span><span class="s1">Current)</span>

    <span class="s3">def </span><span class="s1">test_method_takes_not_enough_args(self):</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">implementer</span>
        <span class="s3">from </span><span class="s1">zope.interface.exceptions </span><span class="s3">import </span><span class="s1">BrokenMethodImplementation</span>

        <span class="s3">class </span><span class="s1">ICurrent(Interface):</span>

            <span class="s3">def </span><span class="s1">method(a):</span>
                <span class="s2">&quot;&quot;&quot;docstring&quot;&quot;&quot;</span>

        <span class="s1">@implementer(ICurrent)</span>
        <span class="s3">class </span><span class="s1">Current(object):</span>

            <span class="s3">def </span><span class="s1">method(self):</span>
                <span class="s3">raise </span><span class="s1">NotImplementedError()</span>

        <span class="s1">self.assertRaises(BrokenMethodImplementation</span><span class="s3">,</span>
                          <span class="s1">self._callFUT</span><span class="s3">, </span><span class="s1">ICurrent</span><span class="s3">, </span><span class="s1">Current)</span>

    <span class="s3">def </span><span class="s1">test_method_doesnt_take_required_starargs(self):</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">implementer</span>
        <span class="s3">from </span><span class="s1">zope.interface.exceptions </span><span class="s3">import </span><span class="s1">BrokenMethodImplementation</span>

        <span class="s3">class </span><span class="s1">ICurrent(Interface):</span>

            <span class="s3">def </span><span class="s1">method(*args):</span>
                <span class="s2">&quot;&quot;&quot;docstring&quot;&quot;&quot;</span>

        <span class="s1">@implementer(ICurrent)</span>
        <span class="s3">class </span><span class="s1">Current(object):</span>

            <span class="s3">def </span><span class="s1">method(self):</span>
                <span class="s3">raise </span><span class="s1">NotImplementedError()</span>

        <span class="s1">self.assertRaises(BrokenMethodImplementation</span><span class="s3">,</span>
                          <span class="s1">self._callFUT</span><span class="s3">, </span><span class="s1">ICurrent</span><span class="s3">, </span><span class="s1">Current)</span>

    <span class="s3">def </span><span class="s1">test_method_doesnt_take_required_only_kwargs(self):</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">implementer</span>
        <span class="s3">from </span><span class="s1">zope.interface.exceptions </span><span class="s3">import </span><span class="s1">BrokenMethodImplementation</span>

        <span class="s3">class </span><span class="s1">ICurrent(Interface):</span>

            <span class="s3">def </span><span class="s1">method(**kw):</span>
                <span class="s2">&quot;&quot;&quot;docstring&quot;&quot;&quot;</span>

        <span class="s1">@implementer(ICurrent)</span>
        <span class="s3">class </span><span class="s1">Current(object):</span>

            <span class="s3">def </span><span class="s1">method(self):</span>
                <span class="s3">raise </span><span class="s1">NotImplementedError()</span>

        <span class="s1">self.assertRaises(BrokenMethodImplementation</span><span class="s3">,</span>
                          <span class="s1">self._callFUT</span><span class="s3">, </span><span class="s1">ICurrent</span><span class="s3">, </span><span class="s1">Current)</span>

    <span class="s3">def </span><span class="s1">test_method_takes_extra_arg(self):</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">implementer</span>
        <span class="s3">from </span><span class="s1">zope.interface.exceptions </span><span class="s3">import </span><span class="s1">BrokenMethodImplementation</span>

        <span class="s3">class </span><span class="s1">ICurrent(Interface):</span>

            <span class="s3">def </span><span class="s1">method(a):</span>
                <span class="s2">&quot;&quot;&quot;docstring&quot;&quot;&quot;</span>

        <span class="s1">@implementer(ICurrent)</span>
        <span class="s3">class </span><span class="s1">Current(object):</span>

            <span class="s3">def </span><span class="s1">method(self</span><span class="s3">, </span><span class="s1">a</span><span class="s3">, </span><span class="s1">b):</span>
                <span class="s3">raise </span><span class="s1">NotImplementedError()</span>

        <span class="s1">self.assertRaises(BrokenMethodImplementation</span><span class="s3">,</span>
                          <span class="s1">self._callFUT</span><span class="s3">, </span><span class="s1">ICurrent</span><span class="s3">, </span><span class="s1">Current)</span>

    <span class="s3">def </span><span class="s1">test_method_takes_extra_arg_with_default(self):</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">implementer</span>

        <span class="s3">class </span><span class="s1">ICurrent(Interface):</span>

            <span class="s3">def </span><span class="s1">method(a):</span>
                <span class="s2">&quot;&quot;&quot;docstring&quot;&quot;&quot;</span>

        <span class="s1">@implementer(ICurrent)</span>
        <span class="s3">class </span><span class="s1">Current(object):</span>

            <span class="s3">def </span><span class="s1">method(self</span><span class="s3">, </span><span class="s1">a</span><span class="s3">, </span><span class="s1">b=</span><span class="s3">None</span><span class="s1">):</span>
                <span class="s3">raise </span><span class="s1">NotImplementedError()</span>

        <span class="s1">self._callFUT(ICurrent</span><span class="s3">, </span><span class="s1">Current)</span>

    <span class="s3">def </span><span class="s1">test_method_takes_only_positional_args(self):</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">implementer</span>

        <span class="s3">class </span><span class="s1">ICurrent(Interface):</span>

            <span class="s3">def </span><span class="s1">method(a):</span>
                <span class="s2">&quot;&quot;&quot;docstring&quot;&quot;&quot;</span>

        <span class="s1">@implementer(ICurrent)</span>
        <span class="s3">class </span><span class="s1">Current(object):</span>

            <span class="s3">def </span><span class="s1">method(self</span><span class="s3">, </span><span class="s1">*args):</span>
                <span class="s3">raise </span><span class="s1">NotImplementedError()</span>

        <span class="s1">self._callFUT(ICurrent</span><span class="s3">, </span><span class="s1">Current)</span>

    <span class="s3">def </span><span class="s1">test_method_takes_only_kwargs(self):</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">implementer</span>
        <span class="s3">from </span><span class="s1">zope.interface.exceptions </span><span class="s3">import </span><span class="s1">BrokenMethodImplementation</span>

        <span class="s3">class </span><span class="s1">ICurrent(Interface):</span>

            <span class="s3">def </span><span class="s1">method(a):</span>
                <span class="s2">&quot;&quot;&quot;docstring&quot;&quot;&quot;</span>

        <span class="s1">@implementer(ICurrent)</span>
        <span class="s3">class </span><span class="s1">Current(object):</span>

            <span class="s3">def </span><span class="s1">method(self</span><span class="s3">, </span><span class="s1">**kw):</span>
                <span class="s3">raise </span><span class="s1">NotImplementedError()</span>

        <span class="s1">self.assertRaises(BrokenMethodImplementation</span><span class="s3">,</span>
                          <span class="s1">self._callFUT</span><span class="s3">, </span><span class="s1">ICurrent</span><span class="s3">, </span><span class="s1">Current)</span>

    <span class="s3">def </span><span class="s1">test_method_takes_extra_starargs(self):</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">implementer</span>

        <span class="s3">class </span><span class="s1">ICurrent(Interface):</span>

            <span class="s3">def </span><span class="s1">method(a):</span>
                <span class="s2">&quot;&quot;&quot;docstring&quot;&quot;&quot;</span>

        <span class="s1">@implementer(ICurrent)</span>
        <span class="s3">class </span><span class="s1">Current(object):</span>

            <span class="s3">def </span><span class="s1">method(self</span><span class="s3">, </span><span class="s1">a</span><span class="s3">, </span><span class="s1">*args):</span>
                <span class="s3">raise </span><span class="s1">NotImplementedError()</span>

        <span class="s1">self._callFUT(ICurrent</span><span class="s3">, </span><span class="s1">Current)</span>

    <span class="s3">def </span><span class="s1">test_method_takes_extra_starargs_and_kwargs(self):</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">implementer</span>

        <span class="s3">class </span><span class="s1">ICurrent(Interface):</span>

            <span class="s3">def </span><span class="s1">method(a):</span>
                <span class="s2">&quot;&quot;&quot;docstring&quot;&quot;&quot;</span>

        <span class="s1">@implementer(ICurrent)</span>
        <span class="s3">class </span><span class="s1">Current(object):</span>

            <span class="s3">def </span><span class="s1">method(self</span><span class="s3">, </span><span class="s1">a</span><span class="s3">, </span><span class="s1">*args</span><span class="s3">, </span><span class="s1">**kw):</span>
                <span class="s3">raise </span><span class="s1">NotImplementedError()</span>

        <span class="s1">self._callFUT(ICurrent</span><span class="s3">, </span><span class="s1">Current)</span>

    <span class="s3">def </span><span class="s1">test_method_doesnt_take_required_positional_and_starargs(self):</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">implementer</span>
        <span class="s3">from </span><span class="s1">zope.interface.exceptions </span><span class="s3">import </span><span class="s1">BrokenMethodImplementation</span>

        <span class="s3">class </span><span class="s1">ICurrent(Interface):</span>

            <span class="s3">def </span><span class="s1">method(a</span><span class="s3">, </span><span class="s1">*args):</span>
                <span class="s2">&quot;&quot;&quot;docstring&quot;&quot;&quot;</span>

        <span class="s1">@implementer(ICurrent)</span>
        <span class="s3">class </span><span class="s1">Current(object):</span>

            <span class="s3">def </span><span class="s1">method(self</span><span class="s3">, </span><span class="s1">a):</span>
                <span class="s3">raise </span><span class="s1">NotImplementedError()</span>

        <span class="s1">self.assertRaises(BrokenMethodImplementation</span><span class="s3">,</span>
                          <span class="s1">self._callFUT</span><span class="s3">, </span><span class="s1">ICurrent</span><span class="s3">, </span><span class="s1">Current)</span>

    <span class="s3">def </span><span class="s1">test_method_takes_required_positional_and_starargs(self):</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">implementer</span>

        <span class="s3">class </span><span class="s1">ICurrent(Interface):</span>

            <span class="s3">def </span><span class="s1">method(a</span><span class="s3">, </span><span class="s1">*args):</span>
                <span class="s2">&quot;&quot;&quot;docstring&quot;&quot;&quot;</span>

        <span class="s1">@implementer(ICurrent)</span>
        <span class="s3">class </span><span class="s1">Current(object):</span>

            <span class="s3">def </span><span class="s1">method(self</span><span class="s3">, </span><span class="s1">a</span><span class="s3">, </span><span class="s1">*args):</span>
                <span class="s3">raise </span><span class="s1">NotImplementedError()</span>

        <span class="s1">self._callFUT(ICurrent</span><span class="s3">, </span><span class="s1">Current)</span>

    <span class="s3">def </span><span class="s1">test_method_takes_only_starargs(self):</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">implementer</span>

        <span class="s3">class </span><span class="s1">ICurrent(Interface):</span>

            <span class="s3">def </span><span class="s1">method(a</span><span class="s3">, </span><span class="s1">*args):</span>
                <span class="s2">&quot;&quot;&quot;docstring&quot;&quot;&quot;</span>

        <span class="s1">@implementer(ICurrent)</span>
        <span class="s3">class </span><span class="s1">Current(object):</span>

            <span class="s3">def </span><span class="s1">method(self</span><span class="s3">, </span><span class="s1">*args):</span>
                <span class="s3">raise </span><span class="s1">NotImplementedError()</span>

        <span class="s1">self._callFUT(ICurrent</span><span class="s3">, </span><span class="s1">Current)</span>

    <span class="s3">def </span><span class="s1">test_method_takes_required_kwargs(self):</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">implementer</span>

        <span class="s3">class </span><span class="s1">ICurrent(Interface):</span>

            <span class="s3">def </span><span class="s1">method(**kwargs):</span>
                <span class="s2">&quot;&quot;&quot;docstring&quot;&quot;&quot;</span>

        <span class="s1">@implementer(ICurrent)</span>
        <span class="s3">class </span><span class="s1">Current(object):</span>

            <span class="s3">def </span><span class="s1">method(self</span><span class="s3">, </span><span class="s1">**kw):</span>
                <span class="s3">raise </span><span class="s1">NotImplementedError()</span>

        <span class="s1">self._callFUT(ICurrent</span><span class="s3">, </span><span class="s1">Current)</span>

    <span class="s3">def </span><span class="s1">test_method_takes_positional_plus_required_starargs(self):</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">implementer</span>
        <span class="s3">from </span><span class="s1">zope.interface.exceptions </span><span class="s3">import </span><span class="s1">BrokenMethodImplementation</span>

        <span class="s3">class </span><span class="s1">ICurrent(Interface):</span>

            <span class="s3">def </span><span class="s1">method(*args):</span>
                <span class="s2">&quot;&quot;&quot;docstring&quot;&quot;&quot;</span>

        <span class="s1">@implementer(ICurrent)</span>
        <span class="s3">class </span><span class="s1">Current(object):</span>

            <span class="s3">def </span><span class="s1">method(self</span><span class="s3">, </span><span class="s1">a</span><span class="s3">, </span><span class="s1">*args):</span>
                <span class="s3">raise </span><span class="s1">NotImplementedError()</span>

        <span class="s1">self.assertRaises(BrokenMethodImplementation</span><span class="s3">,</span>
                          <span class="s1">self._callFUT</span><span class="s3">, </span><span class="s1">ICurrent</span><span class="s3">, </span><span class="s1">Current)</span>


    <span class="s3">def </span><span class="s1">test_method_doesnt_take_required_kwargs(self):</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">implementer</span>
        <span class="s3">from </span><span class="s1">zope.interface.exceptions </span><span class="s3">import </span><span class="s1">BrokenMethodImplementation</span>

        <span class="s3">class </span><span class="s1">ICurrent(Interface):</span>

            <span class="s3">def </span><span class="s1">method(**kwargs):</span>
                <span class="s2">&quot;&quot;&quot;docstring&quot;&quot;&quot;</span>

        <span class="s1">@implementer(ICurrent)</span>
        <span class="s3">class </span><span class="s1">Current(object):</span>

            <span class="s3">def </span><span class="s1">method(self</span><span class="s3">, </span><span class="s1">a):</span>
                <span class="s3">raise </span><span class="s1">NotImplementedError()</span>

        <span class="s1">self.assertRaises(BrokenMethodImplementation</span><span class="s3">,</span>
                          <span class="s1">self._callFUT</span><span class="s3">, </span><span class="s1">ICurrent</span><span class="s3">, </span><span class="s1">Current)</span>


    <span class="s3">def </span><span class="s1">test_class_has_method_for_iface_attr(self):</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Attribute</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">implementer</span>

        <span class="s3">class </span><span class="s1">ICurrent(Interface):</span>
            <span class="s1">attr = Attribute(</span><span class="s4">&quot;The foo Attribute&quot;</span><span class="s1">)</span>

        <span class="s1">@implementer(ICurrent)</span>
        <span class="s3">class </span><span class="s1">Current:</span>

            <span class="s3">def </span><span class="s1">attr(self):</span>
                <span class="s3">raise </span><span class="s1">NotImplementedError()</span>

        <span class="s1">self._callFUT(ICurrent</span><span class="s3">, </span><span class="s1">Current)</span>

    <span class="s3">def </span><span class="s1">test_class_has_nonmethod_for_method(self):</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">implementer</span>
        <span class="s3">from </span><span class="s1">zope.interface.exceptions </span><span class="s3">import </span><span class="s1">BrokenMethodImplementation</span>

        <span class="s3">class </span><span class="s1">ICurrent(Interface):</span>
            <span class="s3">def </span><span class="s1">method():</span>
                <span class="s2">&quot;&quot;&quot;docstring&quot;&quot;&quot;</span>

        <span class="s1">@implementer(ICurrent)</span>
        <span class="s3">class </span><span class="s1">Current:</span>
            <span class="s1">method = </span><span class="s5">1</span>

        <span class="s1">self.assertRaises(BrokenMethodImplementation</span><span class="s3">,</span>
                          <span class="s1">self._callFUT</span><span class="s3">, </span><span class="s1">ICurrent</span><span class="s3">, </span><span class="s1">Current)</span>

    <span class="s3">def </span><span class="s1">test_class_has_attribute_for_attribute(self):</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Attribute</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">implementer</span>

        <span class="s3">class </span><span class="s1">ICurrent(Interface):</span>
            <span class="s1">attr = Attribute(</span><span class="s4">&quot;The foo Attribute&quot;</span><span class="s1">)</span>

        <span class="s1">@implementer(ICurrent)</span>
        <span class="s3">class </span><span class="s1">Current:</span>

            <span class="s1">attr = </span><span class="s5">1</span>

        <span class="s1">self._callFUT(ICurrent</span><span class="s3">, </span><span class="s1">Current)</span>

    <span class="s3">def </span><span class="s1">test_class_misses_attribute_for_attribute(self):</span>
        <span class="s0"># This check *passes* for verifyClass</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Attribute</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">implementer</span>

        <span class="s3">class </span><span class="s1">ICurrent(Interface):</span>
            <span class="s1">attr = Attribute(</span><span class="s4">&quot;The foo Attribute&quot;</span><span class="s1">)</span>

        <span class="s1">@implementer(ICurrent)</span>
        <span class="s3">class </span><span class="s1">Current:</span>
            <span class="s3">pass</span>

        <span class="s1">self._callFUT(ICurrent</span><span class="s3">, </span><span class="s1">Current)</span>

    <span class="s3">def </span><span class="s1">test_w_callable_non_func_method(self):</span>
        <span class="s3">from </span><span class="s1">zope.interface.interface </span><span class="s3">import </span><span class="s1">Method</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">implementer</span>

        <span class="s3">class </span><span class="s1">QuasiMethod(Method):</span>
            <span class="s3">def </span><span class="s1">__call__(self</span><span class="s3">, </span><span class="s1">*args</span><span class="s3">, </span><span class="s1">**kw):</span>
                <span class="s3">raise </span><span class="s1">NotImplementedError()</span>

        <span class="s3">class </span><span class="s1">QuasiCallable(object):</span>
            <span class="s3">def </span><span class="s1">__call__(self</span><span class="s3">, </span><span class="s1">*args</span><span class="s3">, </span><span class="s1">**kw):</span>
                <span class="s3">raise </span><span class="s1">NotImplementedError()</span>

        <span class="s3">class </span><span class="s1">ICurrent(Interface):</span>
            <span class="s1">attr = QuasiMethod(</span><span class="s4">'This is callable'</span><span class="s1">)</span>

        <span class="s1">@implementer(ICurrent)</span>
        <span class="s3">class </span><span class="s1">Current:</span>
            <span class="s1">attr = QuasiCallable()</span>

        <span class="s1">self._callFUT(ICurrent</span><span class="s3">, </span><span class="s1">Current)</span>


    <span class="s3">def </span><span class="s1">test_w_decorated_method(self):</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">implementer</span>

        <span class="s3">def </span><span class="s1">decorator(func):</span>
            <span class="s0"># this is, in fact, zope.proxy.non_overridable</span>
            <span class="s3">return </span><span class="s1">property(</span><span class="s3">lambda </span><span class="s1">self: func.__get__(self))</span>

        <span class="s3">class </span><span class="s1">ICurrent(Interface):</span>

            <span class="s3">def </span><span class="s1">method(a):</span>
                <span class="s2">&quot;&quot;&quot;docstring&quot;&quot;&quot;</span>

        <span class="s1">@implementer(ICurrent)</span>
        <span class="s3">class </span><span class="s1">Current(object):</span>

            <span class="s1">@decorator</span>
            <span class="s3">def </span><span class="s1">method(self</span><span class="s3">, </span><span class="s1">a):</span>
                <span class="s3">raise </span><span class="s1">NotImplementedError()</span>

        <span class="s1">self._callFUT(ICurrent</span><span class="s3">, </span><span class="s1">Current)</span>

    <span class="s3">def </span><span class="s1">test_dict_IFullMapping(self):</span>
        <span class="s0"># A dict should be an IFullMapping, but this exposes two</span>
        <span class="s0"># issues. First, on CPython, methods of builtin types are</span>
        <span class="s0"># &quot;method_descriptor&quot; objects, and are harder to introspect.</span>
        <span class="s0"># Second, on PyPy, the signatures can be just plain wrong,</span>
        <span class="s0"># specifying as required arguments that are actually optional.</span>
        <span class="s0"># See https://github.com/zopefoundation/zope.interface/issues/118</span>
        <span class="s3">from </span><span class="s1">zope.interface.common.mapping </span><span class="s3">import </span><span class="s1">IFullMapping</span>
        <span class="s1">self._callFUT(IFullMapping</span><span class="s3">, </span><span class="s1">dict</span><span class="s3">, </span><span class="s1">tentative=</span><span class="s3">True</span><span class="s1">)</span>

    <span class="s3">def </span><span class="s1">test_list_ISequence(self):</span>
        <span class="s0"># As for test_dict_IFullMapping</span>
        <span class="s3">from </span><span class="s1">zope.interface.common.sequence </span><span class="s3">import </span><span class="s1">ISequence</span>
        <span class="s1">self._callFUT(ISequence</span><span class="s3">, </span><span class="s1">list</span><span class="s3">, </span><span class="s1">tentative=</span><span class="s3">True</span><span class="s1">)</span>

    <span class="s3">def </span><span class="s1">test_tuple_IReadSequence(self):</span>
        <span class="s0"># As for test_dict_IFullMapping</span>
        <span class="s3">from </span><span class="s1">zope.interface.common.sequence </span><span class="s3">import </span><span class="s1">IReadSequence</span>
        <span class="s1">self._callFUT(IReadSequence</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">, </span><span class="s1">tentative=</span><span class="s3">True</span><span class="s1">)</span>


    <span class="s3">def </span><span class="s1">test_multiple_invalid(self):</span>
        <span class="s3">from </span><span class="s1">zope.interface.exceptions </span><span class="s3">import </span><span class="s1">MultipleInvalid</span>
        <span class="s3">from </span><span class="s1">zope.interface.exceptions </span><span class="s3">import </span><span class="s1">DoesNotImplement</span>
        <span class="s3">from </span><span class="s1">zope.interface.exceptions </span><span class="s3">import </span><span class="s1">BrokenImplementation</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">classImplements</span>

        <span class="s3">class </span><span class="s1">ISeveralMethods(Interface):</span>
            <span class="s3">def </span><span class="s1">meth1(arg1):</span>
                <span class="s2">&quot;Method 1&quot;</span>
            <span class="s3">def </span><span class="s1">meth2(arg1):</span>
                <span class="s2">&quot;Method 2&quot;</span>

        <span class="s3">class </span><span class="s1">SeveralMethods(object):</span>
            <span class="s3">pass</span>

        <span class="s3">with </span><span class="s1">self.assertRaises(MultipleInvalid) </span><span class="s3">as </span><span class="s1">exc:</span>
            <span class="s1">self._callFUT(ISeveralMethods</span><span class="s3">, </span><span class="s1">SeveralMethods)</span>

        <span class="s1">ex = exc.exception</span>
        <span class="s1">self.assertEqual(</span><span class="s5">3</span><span class="s3">, </span><span class="s1">len(ex.exceptions))</span>
        <span class="s1">self.assertIsInstance(ex.exceptions[</span><span class="s5">0</span><span class="s1">]</span><span class="s3">, </span><span class="s1">DoesNotImplement)</span>
        <span class="s1">self.assertIsInstance(ex.exceptions[</span><span class="s5">1</span><span class="s1">]</span><span class="s3">, </span><span class="s1">BrokenImplementation)</span>
        <span class="s1">self.assertIsInstance(ex.exceptions[</span><span class="s5">2</span><span class="s1">]</span><span class="s3">, </span><span class="s1">BrokenImplementation)</span>

        <span class="s0"># If everything else is correct, only the single error is raised without</span>
        <span class="s0"># the wrapper.</span>
        <span class="s1">classImplements(SeveralMethods</span><span class="s3">, </span><span class="s1">ISeveralMethods)</span>
        <span class="s1">SeveralMethods.meth1 = </span><span class="s3">lambda </span><span class="s1">self</span><span class="s3">, </span><span class="s1">arg1: </span><span class="s4">&quot;Hi&quot;</span>

        <span class="s3">with </span><span class="s1">self.assertRaises(BrokenImplementation):</span>
            <span class="s1">self._callFUT(ISeveralMethods</span><span class="s3">, </span><span class="s1">SeveralMethods)</span>

<span class="s3">class </span><span class="s1">Test_verifyObject(Test_verifyClass):</span>

    <span class="s1">@classmethod</span>
    <span class="s3">def </span><span class="s1">_get_FUT(cls):</span>
        <span class="s3">from </span><span class="s1">zope.interface.verify </span><span class="s3">import </span><span class="s1">verifyObject</span>
        <span class="s3">return </span><span class="s1">verifyObject</span>

    <span class="s3">def </span><span class="s1">_adjust_object_before_verify(self</span><span class="s3">, </span><span class="s1">target):</span>
        <span class="s3">if </span><span class="s1">isinstance(target</span><span class="s3">, </span><span class="s1">(type</span><span class="s3">, </span><span class="s1">type(OldSkool))):</span>
            <span class="s1">target = target()</span>
        <span class="s3">return </span><span class="s1">target</span>

    <span class="s3">def </span><span class="s1">test_class_misses_attribute_for_attribute(self):</span>
        <span class="s0"># This check *fails* for verifyObject</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Attribute</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">implementer</span>
        <span class="s3">from </span><span class="s1">zope.interface.exceptions </span><span class="s3">import </span><span class="s1">BrokenImplementation</span>

        <span class="s3">class </span><span class="s1">ICurrent(Interface):</span>
            <span class="s1">attr = Attribute(</span><span class="s4">&quot;The foo Attribute&quot;</span><span class="s1">)</span>

        <span class="s1">@implementer(ICurrent)</span>
        <span class="s3">class </span><span class="s1">Current:</span>
            <span class="s3">pass</span>

        <span class="s1">self.assertRaises(BrokenImplementation</span><span class="s3">,</span>
                          <span class="s1">self._callFUT</span><span class="s3">, </span><span class="s1">ICurrent</span><span class="s3">, </span><span class="s1">Current)</span>

    <span class="s3">def </span><span class="s1">test_module_hit(self):</span>
        <span class="s3">from </span><span class="s1">zope.interface.tests.idummy </span><span class="s3">import </span><span class="s1">IDummyModule</span>
        <span class="s3">from </span><span class="s1">zope.interface.tests </span><span class="s3">import </span><span class="s1">dummy</span>

        <span class="s1">self._callFUT(IDummyModule</span><span class="s3">, </span><span class="s1">dummy)</span>

    <span class="s3">def </span><span class="s1">test_module_miss(self):</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface.tests </span><span class="s3">import </span><span class="s1">dummy</span>
        <span class="s3">from </span><span class="s1">zope.interface.exceptions </span><span class="s3">import </span><span class="s1">DoesNotImplement</span>

        <span class="s0"># same name, different object</span>
        <span class="s3">class </span><span class="s1">IDummyModule(Interface):</span>
            <span class="s3">pass</span>

        <span class="s1">self.assertRaises(DoesNotImplement</span><span class="s3">,</span>
                          <span class="s1">self._callFUT</span><span class="s3">, </span><span class="s1">IDummyModule</span><span class="s3">, </span><span class="s1">dummy)</span>

    <span class="s3">def </span><span class="s1">test_staticmethod_hit_on_class(self):</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">Interface</span>
        <span class="s3">from </span><span class="s1">zope.interface </span><span class="s3">import </span><span class="s1">provider</span>
        <span class="s3">from </span><span class="s1">zope.interface.verify </span><span class="s3">import </span><span class="s1">verifyObject</span>

        <span class="s3">class </span><span class="s1">IFoo(Interface):</span>

            <span class="s3">def </span><span class="s1">bar(a</span><span class="s3">, </span><span class="s1">b):</span>
                <span class="s2">&quot;The bar method&quot;</span>

        <span class="s1">@provider(IFoo)</span>
        <span class="s3">class </span><span class="s1">Foo(object):</span>

            <span class="s1">@staticmethod</span>
            <span class="s3">def </span><span class="s1">bar(a</span><span class="s3">, </span><span class="s1">b):</span>
                <span class="s3">raise </span><span class="s1">AssertionError(</span><span class="s4">&quot;We're never actually called&quot;</span><span class="s1">)</span>

        <span class="s0"># Don't use self._callFUT, we don't want to instantiate the</span>
        <span class="s0"># class.</span>
        <span class="s1">verifyObject(IFoo</span><span class="s3">, </span><span class="s1">Foo)</span>

<span class="s3">class </span><span class="s1">OldSkool:</span>
    <span class="s3">pass</span>
</pre>
</body>
</html>