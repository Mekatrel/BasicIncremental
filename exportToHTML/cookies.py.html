<html>
<head>
<title>cookies.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #808080;}
.s1 { color: #a9b7c6;}
.s2 { color: #629755; font-style: italic;}
.s3 { color: #cc7832;}
.s4 { color: #6897bb;}
.s5 { color: #6a8759;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
cookies.py</font>
</center></td></tr></table>
<pre><span class="s0">####</span>
<span class="s0"># Copyright 2000 by Timothy O'Malley &lt;timo@alum.mit.edu&gt;</span>
<span class="s0">#</span>
<span class="s0">#                All Rights Reserved</span>
<span class="s0">#</span>
<span class="s0"># Permission to use, copy, modify, and distribute this software</span>
<span class="s0"># and its documentation for any purpose and without fee is hereby</span>
<span class="s0"># granted, provided that the above copyright notice appear in all</span>
<span class="s0"># copies and that both that copyright notice and this permission</span>
<span class="s0"># notice appear in supporting documentation, and that the name of</span>
<span class="s0"># Timothy O'Malley  not be used in advertising or publicity</span>
<span class="s0"># pertaining to distribution of the software without specific, written</span>
<span class="s0"># prior permission.</span>
<span class="s0">#</span>
<span class="s0"># Timothy O'Malley DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS</span>
<span class="s0"># SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY</span>
<span class="s0"># AND FITNESS, IN NO EVENT SHALL Timothy O'Malley BE LIABLE FOR</span>
<span class="s0"># ANY SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES</span>
<span class="s0"># WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS,</span>
<span class="s0"># WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS</span>
<span class="s0"># ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR</span>
<span class="s0"># PERFORMANCE OF THIS SOFTWARE.</span>
<span class="s0">#</span>
<span class="s0">####</span>
<span class="s0">#</span>
<span class="s0"># Id: Cookie.py,v 2.29 2000/08/23 05:28:49 timo Exp</span>
<span class="s0">#   by Timothy O'Malley &lt;timo@alum.mit.edu&gt;</span>
<span class="s0">#</span>
<span class="s0">#  Cookie.py is a Python module for the handling of HTTP</span>
<span class="s0">#  cookies as a Python dictionary.  See RFC 2109 for more</span>
<span class="s0">#  information on cookies.</span>
<span class="s0">#</span>
<span class="s0">#  The original idea to treat Cookies as a dictionary came from</span>
<span class="s0">#  Dave Mitchell (davem@magnet.com) in 1995, when he released the</span>
<span class="s0">#  first version of nscookie.py.</span>
<span class="s0">#</span>
<span class="s0">####</span>

<span class="s2">r&quot;&quot;&quot; 
http.cookies module ported to python-future from Py3.3 
 
Here's a sample session to show how to use this module. 
At the moment, this is the only documentation. 
 
The Basics 
---------- 
 
Importing is easy... 
 
   &gt;&gt;&gt; from http import cookies 
 
Most of the time you start by creating a cookie. 
 
   &gt;&gt;&gt; C = cookies.SimpleCookie() 
 
Once you've created your Cookie, you can add values just as if it were 
a dictionary. 
 
   &gt;&gt;&gt; C = cookies.SimpleCookie() 
   &gt;&gt;&gt; C[&quot;fig&quot;] = &quot;newton&quot; 
   &gt;&gt;&gt; C[&quot;sugar&quot;] = &quot;wafer&quot; 
   &gt;&gt;&gt; C.output() 
   'Set-Cookie: fig=newton\r\nSet-Cookie: sugar=wafer' 
 
Notice that the printable representation of a Cookie is the 
appropriate format for a Set-Cookie: header.  This is the 
default behavior.  You can change the header and printed 
attributes by using the .output() function 
 
   &gt;&gt;&gt; C = cookies.SimpleCookie() 
   &gt;&gt;&gt; C[&quot;rocky&quot;] = &quot;road&quot; 
   &gt;&gt;&gt; C[&quot;rocky&quot;][&quot;path&quot;] = &quot;/cookie&quot; 
   &gt;&gt;&gt; print(C.output(header=&quot;Cookie:&quot;)) 
   Cookie: rocky=road; Path=/cookie 
   &gt;&gt;&gt; print(C.output(attrs=[], header=&quot;Cookie:&quot;)) 
   Cookie: rocky=road 
 
The load() method of a Cookie extracts cookies from a string.  In a 
CGI script, you would use this method to extract the cookies from the 
HTTP_COOKIE environment variable. 
 
   &gt;&gt;&gt; C = cookies.SimpleCookie() 
   &gt;&gt;&gt; C.load(&quot;chips=ahoy; vienna=finger&quot;) 
   &gt;&gt;&gt; C.output() 
   'Set-Cookie: chips=ahoy\r\nSet-Cookie: vienna=finger' 
 
The load() method is darn-tootin smart about identifying cookies 
within a string.  Escaped quotation marks, nested semicolons, and other 
such trickeries do not confuse it. 
 
   &gt;&gt;&gt; C = cookies.SimpleCookie() 
   &gt;&gt;&gt; C.load('keebler=&quot;E=everybody; L=\\&quot;Loves\\&quot;; fudge=\\012;&quot;;') 
   &gt;&gt;&gt; print(C) 
   Set-Cookie: keebler=&quot;E=everybody; L=\&quot;Loves\&quot;; fudge=\012;&quot; 
 
Each element of the Cookie also supports all of the RFC 2109 
Cookie attributes.  Here's an example which sets the Path 
attribute. 
 
   &gt;&gt;&gt; C = cookies.SimpleCookie() 
   &gt;&gt;&gt; C[&quot;oreo&quot;] = &quot;doublestuff&quot; 
   &gt;&gt;&gt; C[&quot;oreo&quot;][&quot;path&quot;] = &quot;/&quot; 
   &gt;&gt;&gt; print(C) 
   Set-Cookie: oreo=doublestuff; Path=/ 
 
Each dictionary element has a 'value' attribute, which gives you 
back the value associated with the key. 
 
   &gt;&gt;&gt; C = cookies.SimpleCookie() 
   &gt;&gt;&gt; C[&quot;twix&quot;] = &quot;none for you&quot; 
   &gt;&gt;&gt; C[&quot;twix&quot;].value 
   'none for you' 
 
The SimpleCookie expects that all values should be standard strings. 
Just to be sure, SimpleCookie invokes the str() builtin to convert 
the value to a string, when the values are set dictionary-style. 
 
   &gt;&gt;&gt; C = cookies.SimpleCookie() 
   &gt;&gt;&gt; C[&quot;number&quot;] = 7 
   &gt;&gt;&gt; C[&quot;string&quot;] = &quot;seven&quot; 
   &gt;&gt;&gt; C[&quot;number&quot;].value 
   '7' 
   &gt;&gt;&gt; C[&quot;string&quot;].value 
   'seven' 
   &gt;&gt;&gt; C.output() 
   'Set-Cookie: number=7\r\nSet-Cookie: string=seven' 
 
Finis. 
&quot;&quot;&quot;</span>
<span class="s3">from </span><span class="s1">__future__ </span><span class="s3">import </span><span class="s1">unicode_literals</span>
<span class="s3">from </span><span class="s1">__future__ </span><span class="s3">import </span><span class="s1">print_function</span>
<span class="s3">from </span><span class="s1">__future__ </span><span class="s3">import </span><span class="s1">division</span>
<span class="s3">from </span><span class="s1">__future__ </span><span class="s3">import </span><span class="s1">absolute_import</span>
<span class="s3">from </span><span class="s1">future.builtins </span><span class="s3">import </span><span class="s1">chr</span><span class="s3">, </span><span class="s1">dict</span><span class="s3">, </span><span class="s1">int</span><span class="s3">, </span><span class="s1">str</span>
<span class="s3">from </span><span class="s1">future.utils </span><span class="s3">import </span><span class="s1">PY2</span><span class="s3">, </span><span class="s1">as_native_str</span>

<span class="s0">#</span>
<span class="s0"># Import our required modules</span>
<span class="s0">#</span>
<span class="s3">import </span><span class="s1">re</span>
<span class="s3">if </span><span class="s1">PY2:</span>
    <span class="s1">re.ASCII = </span><span class="s4">0    </span><span class="s0"># for py2 compatibility</span>
<span class="s3">import </span><span class="s1">string</span>

<span class="s1">__all__ = [</span><span class="s5">&quot;CookieError&quot;</span><span class="s3">, </span><span class="s5">&quot;BaseCookie&quot;</span><span class="s3">, </span><span class="s5">&quot;SimpleCookie&quot;</span><span class="s1">]</span>

<span class="s1">_nulljoin = </span><span class="s5">''</span><span class="s1">.join</span>
<span class="s1">_semispacejoin = </span><span class="s5">'; '</span><span class="s1">.join</span>
<span class="s1">_spacejoin = </span><span class="s5">' '</span><span class="s1">.join</span>

<span class="s0">#</span>
<span class="s0"># Define an exception visible to External modules</span>
<span class="s0">#</span>
<span class="s3">class </span><span class="s1">CookieError(Exception):</span>
    <span class="s3">pass</span>


<span class="s0"># These quoting routines conform to the RFC2109 specification, which in</span>
<span class="s0"># turn references the character definitions from RFC2068.  They provide</span>
<span class="s0"># a two-way quoting algorithm.  Any non-text character is translated</span>
<span class="s0"># into a 4 character sequence: a forward-slash followed by the</span>
<span class="s0"># three-digit octal equivalent of the character.  Any '\' or '&quot;' is</span>
<span class="s0"># quoted with a preceeding '\' slash.</span>
<span class="s0">#</span>
<span class="s0"># These are taken from RFC2068 and RFC2109.</span>
<span class="s0">#       _LegalChars       is the list of chars which don't require &quot;'s</span>
<span class="s0">#       _Translator       hash-table for fast quoting</span>
<span class="s0">#</span>
<span class="s1">_LegalChars       = string.ascii_letters + string.digits + </span><span class="s5">&quot;!#$%&amp;'*+-.^_`|~:&quot;</span>
<span class="s1">_Translator       = {</span>
    <span class="s5">'</span><span class="s3">\000</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">000'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\001</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">001'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\002</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">002'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\003</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">003'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\004</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">004'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\005</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">005'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\006</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">006'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\007</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">007'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\010</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">010'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\011</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">011'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\012</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">012'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\013</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">013'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\014</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">014'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\015</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">015'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\016</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">016'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\017</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">017'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\020</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">020'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\021</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">021'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\022</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">022'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\023</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">023'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\024</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">024'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\025</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">025'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\026</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">026'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\027</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">027'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\030</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">030'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\031</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">031'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\032</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">032'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\033</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">033'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\034</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">034'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\035</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">035'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\036</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">036'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\037</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">037'</span><span class="s3">,</span>

    <span class="s0"># Because of the way browsers really handle cookies (as opposed</span>
    <span class="s0"># to what the RFC says) we also encode , and ;</span>

    <span class="s5">',' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">054'</span><span class="s3">, </span><span class="s5">';' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">073'</span><span class="s3">,</span>

    <span class="s5">'&quot;' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">&quot;'</span><span class="s3">,       </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\\\</span><span class="s5">'</span><span class="s3">,</span>

    <span class="s5">'</span><span class="s3">\177</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">177'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\200</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">200'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\201</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">201'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\202</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">202'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\203</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">203'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\204</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">204'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\205</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">205'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\206</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">206'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\207</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">207'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\210</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">210'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\211</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">211'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\212</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">212'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\213</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">213'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\214</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">214'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\215</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">215'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\216</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">216'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\217</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">217'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\220</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">220'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\221</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">221'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\222</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">222'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\223</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">223'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\224</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">224'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\225</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">225'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\226</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">226'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\227</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">227'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\230</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">230'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\231</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">231'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\232</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">232'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\233</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">233'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\234</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">234'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\235</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">235'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\236</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">236'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\237</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">237'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\240</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">240'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\241</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">241'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\242</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">242'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\243</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">243'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\244</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">244'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\245</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">245'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\246</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">246'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\247</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">247'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\250</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">250'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\251</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">251'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\252</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">252'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\253</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">253'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\254</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">254'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\255</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">255'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\256</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">256'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\257</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">257'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\260</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">260'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\261</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">261'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\262</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">262'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\263</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">263'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\264</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">264'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\265</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">265'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\266</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">266'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\267</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">267'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\270</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">270'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\271</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">271'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\272</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">272'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\273</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">273'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\274</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">274'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\275</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">275'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\276</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">276'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\277</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">277'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\300</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">300'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\301</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">301'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\302</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">302'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\303</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">303'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\304</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">304'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\305</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">305'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\306</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">306'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\307</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">307'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\310</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">310'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\311</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">311'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\312</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">312'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\313</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">313'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\314</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">314'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\315</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">315'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\316</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">316'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\317</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">317'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\320</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">320'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\321</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">321'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\322</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">322'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\323</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">323'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\324</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">324'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\325</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">325'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\326</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">326'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\327</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">327'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\330</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">330'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\331</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">331'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\332</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">332'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\333</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">333'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\334</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">334'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\335</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">335'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\336</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">336'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\337</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">337'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\340</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">340'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\341</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">341'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\342</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">342'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\343</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">343'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\344</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">344'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\345</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">345'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\346</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">346'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\347</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">347'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\350</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">350'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\351</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">351'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\352</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">352'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\353</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">353'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\354</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">354'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\355</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">355'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\356</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">356'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\357</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">357'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\360</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">360'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\361</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">361'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\362</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">362'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\363</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">363'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\364</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">364'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\365</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">365'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\366</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">366'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\367</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">367'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\370</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">370'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\371</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">371'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\372</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">372'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\373</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">373'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\374</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">374'</span><span class="s3">,</span>
    <span class="s5">'</span><span class="s3">\375</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">375'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\376</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">376'</span><span class="s3">,  </span><span class="s5">'</span><span class="s3">\377</span><span class="s5">' </span><span class="s1">: </span><span class="s5">'</span><span class="s3">\\</span><span class="s5">377'</span>
    <span class="s1">}</span>

<span class="s3">def </span><span class="s1">_quote(str</span><span class="s3">, </span><span class="s1">LegalChars=_LegalChars):</span>
    <span class="s2">r&quot;&quot;&quot;Quote a string for use in a cookie header. 
 
    If the string does not need to be double-quoted, then just return the 
    string.  Otherwise, surround the string in doublequotes and quote 
    (with a \) special characters. 
    &quot;&quot;&quot;</span>
    <span class="s3">if </span><span class="s1">all(c </span><span class="s3">in </span><span class="s1">LegalChars </span><span class="s3">for </span><span class="s1">c </span><span class="s3">in </span><span class="s1">str):</span>
        <span class="s3">return </span><span class="s1">str</span>
    <span class="s3">else</span><span class="s1">:</span>
        <span class="s3">return </span><span class="s5">'&quot;' </span><span class="s1">+ _nulljoin(_Translator.get(s</span><span class="s3">, </span><span class="s1">s) </span><span class="s3">for </span><span class="s1">s </span><span class="s3">in </span><span class="s1">str) + </span><span class="s5">'&quot;'</span>


<span class="s1">_OctalPatt = re.compile(</span><span class="s5">r&quot;\\[0-3][0-7][0-7]&quot;</span><span class="s1">)</span>
<span class="s1">_QuotePatt = re.compile(</span><span class="s5">r&quot;[\\].&quot;</span><span class="s1">)</span>

<span class="s3">def </span><span class="s1">_unquote(mystr):</span>
    <span class="s0"># If there aren't any doublequotes,</span>
    <span class="s0"># then there can't be any special characters.  See RFC 2109.</span>
    <span class="s3">if </span><span class="s1">len(mystr) &lt; </span><span class="s4">2</span><span class="s1">:</span>
        <span class="s3">return </span><span class="s1">mystr</span>
    <span class="s3">if </span><span class="s1">mystr[</span><span class="s4">0</span><span class="s1">] != </span><span class="s5">'&quot;' </span><span class="s3">or </span><span class="s1">mystr[-</span><span class="s4">1</span><span class="s1">] != </span><span class="s5">'&quot;'</span><span class="s1">:</span>
        <span class="s3">return </span><span class="s1">mystr</span>

    <span class="s0"># We have to assume that we must decode this string.</span>
    <span class="s0"># Down to work.</span>

    <span class="s0"># Remove the &quot;s</span>
    <span class="s1">mystr = mystr[</span><span class="s4">1</span><span class="s1">:-</span><span class="s4">1</span><span class="s1">]</span>

    <span class="s0"># Check for special sequences.  Examples:</span>
    <span class="s0">#    \012 --&gt; \n</span>
    <span class="s0">#    \&quot;   --&gt; &quot;</span>
    <span class="s0">#</span>
    <span class="s1">i = </span><span class="s4">0</span>
    <span class="s1">n = len(mystr)</span>
    <span class="s1">res = []</span>
    <span class="s3">while </span><span class="s4">0 </span><span class="s1">&lt;= i &lt; n:</span>
        <span class="s1">o_match = _OctalPatt.search(mystr</span><span class="s3">, </span><span class="s1">i)</span>
        <span class="s1">q_match = _QuotePatt.search(mystr</span><span class="s3">, </span><span class="s1">i)</span>
        <span class="s3">if not </span><span class="s1">o_match </span><span class="s3">and not </span><span class="s1">q_match:              </span><span class="s0"># Neither matched</span>
            <span class="s1">res.append(mystr[i:])</span>
            <span class="s3">break</span>
        <span class="s0"># else:</span>
        <span class="s1">j = k = -</span><span class="s4">1</span>
        <span class="s3">if </span><span class="s1">o_match:</span>
            <span class="s1">j = o_match.start(</span><span class="s4">0</span><span class="s1">)</span>
        <span class="s3">if </span><span class="s1">q_match:</span>
            <span class="s1">k = q_match.start(</span><span class="s4">0</span><span class="s1">)</span>
        <span class="s3">if </span><span class="s1">q_match </span><span class="s3">and </span><span class="s1">(</span><span class="s3">not </span><span class="s1">o_match </span><span class="s3">or </span><span class="s1">k &lt; j):     </span><span class="s0"># QuotePatt matched</span>
            <span class="s1">res.append(mystr[i:k])</span>
            <span class="s1">res.append(mystr[k+</span><span class="s4">1</span><span class="s1">])</span>
            <span class="s1">i = k + </span><span class="s4">2</span>
        <span class="s3">else</span><span class="s1">:                                      </span><span class="s0"># OctalPatt matched</span>
            <span class="s1">res.append(mystr[i:j])</span>
            <span class="s1">res.append(chr(int(mystr[j+</span><span class="s4">1</span><span class="s1">:j+</span><span class="s4">4</span><span class="s1">]</span><span class="s3">, </span><span class="s4">8</span><span class="s1">)))</span>
            <span class="s1">i = j + </span><span class="s4">4</span>
    <span class="s3">return </span><span class="s1">_nulljoin(res)</span>

<span class="s0"># The _getdate() routine is used to set the expiration time in the cookie's HTTP</span>
<span class="s0"># header.  By default, _getdate() returns the current time in the appropriate</span>
<span class="s0"># &quot;expires&quot; format for a Set-Cookie header.  The one optional argument is an</span>
<span class="s0"># offset from now, in seconds.  For example, an offset of -3600 means &quot;one hour</span>
<span class="s0"># ago&quot;.  The offset may be a floating point number.</span>
<span class="s0">#</span>

<span class="s1">_weekdayname = [</span><span class="s5">'Mon'</span><span class="s3">, </span><span class="s5">'Tue'</span><span class="s3">, </span><span class="s5">'Wed'</span><span class="s3">, </span><span class="s5">'Thu'</span><span class="s3">, </span><span class="s5">'Fri'</span><span class="s3">, </span><span class="s5">'Sat'</span><span class="s3">, </span><span class="s5">'Sun'</span><span class="s1">]</span>

<span class="s1">_monthname = [</span><span class="s3">None,</span>
              <span class="s5">'Jan'</span><span class="s3">, </span><span class="s5">'Feb'</span><span class="s3">, </span><span class="s5">'Mar'</span><span class="s3">, </span><span class="s5">'Apr'</span><span class="s3">, </span><span class="s5">'May'</span><span class="s3">, </span><span class="s5">'Jun'</span><span class="s3">,</span>
              <span class="s5">'Jul'</span><span class="s3">, </span><span class="s5">'Aug'</span><span class="s3">, </span><span class="s5">'Sep'</span><span class="s3">, </span><span class="s5">'Oct'</span><span class="s3">, </span><span class="s5">'Nov'</span><span class="s3">, </span><span class="s5">'Dec'</span><span class="s1">]</span>

<span class="s3">def </span><span class="s1">_getdate(future=</span><span class="s4">0</span><span class="s3">, </span><span class="s1">weekdayname=_weekdayname</span><span class="s3">, </span><span class="s1">monthname=_monthname):</span>
    <span class="s3">from </span><span class="s1">time </span><span class="s3">import </span><span class="s1">gmtime</span><span class="s3">, </span><span class="s1">time</span>
    <span class="s1">now = time()</span>
    <span class="s1">year</span><span class="s3">, </span><span class="s1">month</span><span class="s3">, </span><span class="s1">day</span><span class="s3">, </span><span class="s1">hh</span><span class="s3">, </span><span class="s1">mm</span><span class="s3">, </span><span class="s1">ss</span><span class="s3">, </span><span class="s1">wd</span><span class="s3">, </span><span class="s1">y</span><span class="s3">, </span><span class="s1">z = gmtime(now + future)</span>
    <span class="s3">return </span><span class="s5">&quot;%s, %02d %3s %4d %02d:%02d:%02d GMT&quot; </span><span class="s1">% \</span>
           <span class="s1">(weekdayname[wd]</span><span class="s3">, </span><span class="s1">day</span><span class="s3">, </span><span class="s1">monthname[month]</span><span class="s3">, </span><span class="s1">year</span><span class="s3">, </span><span class="s1">hh</span><span class="s3">, </span><span class="s1">mm</span><span class="s3">, </span><span class="s1">ss)</span>


<span class="s3">class </span><span class="s1">Morsel(dict):</span>
    <span class="s2">&quot;&quot;&quot;A class to hold ONE (key, value) pair. 
 
    In a cookie, each such pair may have several attributes, so this class is 
    used to keep the attributes associated with the appropriate key,value pair. 
    This class also includes a coded_value attribute, which is used to hold 
    the network representation of the value.  This is most useful when Python 
    objects are pickled for network transit. 
    &quot;&quot;&quot;</span>
    <span class="s0"># RFC 2109 lists these attributes as reserved:</span>
    <span class="s0">#   path       comment         domain</span>
    <span class="s0">#   max-age    secure      version</span>
    <span class="s0">#</span>
    <span class="s0"># For historical reasons, these attributes are also reserved:</span>
    <span class="s0">#   expires</span>
    <span class="s0">#</span>
    <span class="s0"># This is an extension from Microsoft:</span>
    <span class="s0">#   httponly</span>
    <span class="s0">#</span>
    <span class="s0"># This dictionary provides a mapping from the lowercase</span>
    <span class="s0"># variant on the left to the appropriate traditional</span>
    <span class="s0"># formatting on the right.</span>
    <span class="s1">_reserved = {</span>
        <span class="s5">&quot;expires&quot;  </span><span class="s1">: </span><span class="s5">&quot;expires&quot;</span><span class="s3">,</span>
        <span class="s5">&quot;path&quot;     </span><span class="s1">: </span><span class="s5">&quot;Path&quot;</span><span class="s3">,</span>
        <span class="s5">&quot;comment&quot;  </span><span class="s1">: </span><span class="s5">&quot;Comment&quot;</span><span class="s3">,</span>
        <span class="s5">&quot;domain&quot;   </span><span class="s1">: </span><span class="s5">&quot;Domain&quot;</span><span class="s3">,</span>
        <span class="s5">&quot;max-age&quot;  </span><span class="s1">: </span><span class="s5">&quot;Max-Age&quot;</span><span class="s3">,</span>
        <span class="s5">&quot;secure&quot;   </span><span class="s1">: </span><span class="s5">&quot;secure&quot;</span><span class="s3">,</span>
        <span class="s5">&quot;httponly&quot; </span><span class="s1">: </span><span class="s5">&quot;httponly&quot;</span><span class="s3">,</span>
        <span class="s5">&quot;version&quot;  </span><span class="s1">: </span><span class="s5">&quot;Version&quot;</span><span class="s3">,</span>
    <span class="s1">}</span>

    <span class="s1">_flags = set([</span><span class="s5">'secure'</span><span class="s3">, </span><span class="s5">'httponly'</span><span class="s1">])</span>

    <span class="s3">def </span><span class="s1">__init__(self):</span>
        <span class="s0"># Set defaults</span>
        <span class="s1">self.key = self.value = self.coded_value = </span><span class="s3">None</span>

        <span class="s0"># Set default attributes</span>
        <span class="s3">for </span><span class="s1">key </span><span class="s3">in </span><span class="s1">self._reserved:</span>
            <span class="s1">dict.__setitem__(self</span><span class="s3">, </span><span class="s1">key</span><span class="s3">, </span><span class="s5">&quot;&quot;</span><span class="s1">)</span>

    <span class="s3">def </span><span class="s1">__setitem__(self</span><span class="s3">, </span><span class="s1">K</span><span class="s3">, </span><span class="s1">V):</span>
        <span class="s1">K = K.lower()</span>
        <span class="s3">if not </span><span class="s1">K </span><span class="s3">in </span><span class="s1">self._reserved:</span>
            <span class="s3">raise </span><span class="s1">CookieError(</span><span class="s5">&quot;Invalid Attribute %s&quot; </span><span class="s1">% K)</span>
        <span class="s1">dict.__setitem__(self</span><span class="s3">, </span><span class="s1">K</span><span class="s3">, </span><span class="s1">V)</span>

    <span class="s3">def </span><span class="s1">isReservedKey(self</span><span class="s3">, </span><span class="s1">K):</span>
        <span class="s3">return </span><span class="s1">K.lower() </span><span class="s3">in </span><span class="s1">self._reserved</span>

    <span class="s3">def </span><span class="s1">set(self</span><span class="s3">, </span><span class="s1">key</span><span class="s3">, </span><span class="s1">val</span><span class="s3">, </span><span class="s1">coded_val</span><span class="s3">, </span><span class="s1">LegalChars=_LegalChars):</span>
        <span class="s0"># First we verify that the key isn't a reserved word</span>
        <span class="s0"># Second we make sure it only contains legal characters</span>
        <span class="s3">if </span><span class="s1">key.lower() </span><span class="s3">in </span><span class="s1">self._reserved:</span>
            <span class="s3">raise </span><span class="s1">CookieError(</span><span class="s5">&quot;Attempt to set a reserved key: %s&quot; </span><span class="s1">% key)</span>
        <span class="s3">if </span><span class="s1">any(c </span><span class="s3">not in </span><span class="s1">LegalChars </span><span class="s3">for </span><span class="s1">c </span><span class="s3">in </span><span class="s1">key):</span>
            <span class="s3">raise </span><span class="s1">CookieError(</span><span class="s5">&quot;Illegal key value: %s&quot; </span><span class="s1">% key)</span>

        <span class="s0"># It's a good key, so save it.</span>
        <span class="s1">self.key = key</span>
        <span class="s1">self.value = val</span>
        <span class="s1">self.coded_value = coded_val</span>

    <span class="s3">def </span><span class="s1">output(self</span><span class="s3">, </span><span class="s1">attrs=</span><span class="s3">None, </span><span class="s1">header=</span><span class="s5">&quot;Set-Cookie:&quot;</span><span class="s1">):</span>
        <span class="s3">return </span><span class="s5">&quot;%s %s&quot; </span><span class="s1">% (header</span><span class="s3">, </span><span class="s1">self.OutputString(attrs))</span>

    <span class="s1">__str__ = output</span>

    <span class="s1">@as_native_str()</span>
    <span class="s3">def </span><span class="s1">__repr__(self):</span>
        <span class="s3">if </span><span class="s1">PY2 </span><span class="s3">and </span><span class="s1">isinstance(self.value</span><span class="s3">, </span><span class="s1">unicode):</span>
            <span class="s1">val = str(self.value)    </span><span class="s0"># make it a newstr to remove the u prefix</span>
        <span class="s3">else</span><span class="s1">:</span>
            <span class="s1">val = self.value</span>
        <span class="s3">return </span><span class="s5">'&lt;%s: %s=%s&gt;' </span><span class="s1">% (self.__class__.__name__</span><span class="s3">,</span>
                                <span class="s1">str(self.key)</span><span class="s3">, </span><span class="s1">repr(val))</span>

    <span class="s3">def </span><span class="s1">js_output(self</span><span class="s3">, </span><span class="s1">attrs=</span><span class="s3">None</span><span class="s1">):</span>
        <span class="s0"># Print javascript</span>
        <span class="s3">return </span><span class="s5">&quot;&quot;&quot; 
        &lt;script type=&quot;text/javascript&quot;&gt; 
        &lt;!-- begin hiding 
        document.cookie = </span><span class="s3">\&quot;</span><span class="s5">%s</span><span class="s3">\&quot;</span><span class="s5">; 
        // end hiding --&gt; 
        &lt;/script&gt; 
        &quot;&quot;&quot; </span><span class="s1">% (self.OutputString(attrs).replace(</span><span class="s5">'&quot;'</span><span class="s3">, </span><span class="s5">r'\&quot;'</span><span class="s1">))</span>

    <span class="s3">def </span><span class="s1">OutputString(self</span><span class="s3">, </span><span class="s1">attrs=</span><span class="s3">None</span><span class="s1">):</span>
        <span class="s0"># Build up our result</span>
        <span class="s0">#</span>
        <span class="s1">result = []</span>
        <span class="s1">append = result.append</span>

        <span class="s0"># First, the key=value pair</span>
        <span class="s1">append(</span><span class="s5">&quot;%s=%s&quot; </span><span class="s1">% (self.key</span><span class="s3">, </span><span class="s1">self.coded_value))</span>

        <span class="s0"># Now add any defined attributes</span>
        <span class="s3">if </span><span class="s1">attrs </span><span class="s3">is None</span><span class="s1">:</span>
            <span class="s1">attrs = self._reserved</span>
        <span class="s1">items = sorted(self.items())</span>
        <span class="s3">for </span><span class="s1">key</span><span class="s3">, </span><span class="s1">value </span><span class="s3">in </span><span class="s1">items:</span>
            <span class="s3">if </span><span class="s1">value == </span><span class="s5">&quot;&quot;</span><span class="s1">:</span>
                <span class="s3">continue</span>
            <span class="s3">if </span><span class="s1">key </span><span class="s3">not in </span><span class="s1">attrs:</span>
                <span class="s3">continue</span>
            <span class="s3">if </span><span class="s1">key == </span><span class="s5">&quot;expires&quot; </span><span class="s3">and </span><span class="s1">isinstance(value</span><span class="s3">, </span><span class="s1">int):</span>
                <span class="s1">append(</span><span class="s5">&quot;%s=%s&quot; </span><span class="s1">% (self._reserved[key]</span><span class="s3">, </span><span class="s1">_getdate(value)))</span>
            <span class="s3">elif </span><span class="s1">key == </span><span class="s5">&quot;max-age&quot; </span><span class="s3">and </span><span class="s1">isinstance(value</span><span class="s3">, </span><span class="s1">int):</span>
                <span class="s1">append(</span><span class="s5">&quot;%s=%d&quot; </span><span class="s1">% (self._reserved[key]</span><span class="s3">, </span><span class="s1">value))</span>
            <span class="s3">elif </span><span class="s1">key == </span><span class="s5">&quot;secure&quot;</span><span class="s1">:</span>
                <span class="s1">append(str(self._reserved[key]))</span>
            <span class="s3">elif </span><span class="s1">key == </span><span class="s5">&quot;httponly&quot;</span><span class="s1">:</span>
                <span class="s1">append(str(self._reserved[key]))</span>
            <span class="s3">else</span><span class="s1">:</span>
                <span class="s1">append(</span><span class="s5">&quot;%s=%s&quot; </span><span class="s1">% (self._reserved[key]</span><span class="s3">, </span><span class="s1">value))</span>

        <span class="s0"># Return the result</span>
        <span class="s3">return </span><span class="s1">_semispacejoin(result)</span>


<span class="s0">#</span>
<span class="s0"># Pattern for finding cookie</span>
<span class="s0">#</span>
<span class="s0"># This used to be strict parsing based on the RFC2109 and RFC2068</span>
<span class="s0"># specifications.  I have since discovered that MSIE 3.0x doesn't</span>
<span class="s0"># follow the character rules outlined in those specs.  As a</span>
<span class="s0"># result, the parsing rules here are less strict.</span>
<span class="s0">#</span>

<span class="s1">_LegalCharsPatt  = </span><span class="s5">r&quot;[\w\d!#%&amp;'~_`&gt;&lt;@,:/\$\*\+\-\.\^\|\)\(\?\}\{\=]&quot;</span>
<span class="s1">_CookiePattern = re.compile(</span><span class="s5">r&quot;&quot;&quot; 
    (?x)                           # This is a verbose pattern 
    (?P&lt;key&gt;                       # Start of group 'key' 
    &quot;&quot;&quot; </span><span class="s1">+ _LegalCharsPatt + </span><span class="s5">r&quot;&quot;&quot;+?   # Any word of at least one letter 
    )                              # End of group 'key' 
    (                              # Optional group: there may not be a value. 
    \s*=\s*                          # Equal Sign 
    (?P&lt;val&gt;                         # Start of group 'val' 
    &quot;(?:[^\\&quot;]|\\.)*&quot;                  # Any doublequoted string 
    |                                  # or 
    \w{3},\s[\w\d\s-]{9,11}\s[\d:]{8}\sGMT  # Special case for &quot;expires&quot; attr 
    |                                  # or 
    &quot;&quot;&quot; </span><span class="s1">+ _LegalCharsPatt + </span><span class="s5">r&quot;&quot;&quot;*      # Any word or empty string 
    )                                # End of group 'val' 
    )?                             # End of optional value group 
    \s*                            # Any number of spaces. 
    (\s+|;|$)                      # Ending either at space, semicolon, or EOS. 
    &quot;&quot;&quot;</span><span class="s3">, </span><span class="s1">re.ASCII)                 </span><span class="s0"># May be removed if safe.</span>


<span class="s0"># At long last, here is the cookie class.  Using this class is almost just like</span>
<span class="s0"># using a dictionary.  See this module's docstring for example usage.</span>
<span class="s0">#</span>
<span class="s3">class </span><span class="s1">BaseCookie(dict):</span>
    <span class="s2">&quot;&quot;&quot;A container class for a set of Morsels.&quot;&quot;&quot;</span>

    <span class="s3">def </span><span class="s1">value_decode(self</span><span class="s3">, </span><span class="s1">val):</span>
        <span class="s2">&quot;&quot;&quot;real_value, coded_value = value_decode(STRING) 
        Called prior to setting a cookie's value from the network 
        representation.  The VALUE is the value read from HTTP 
        header. 
        Override this function to modify the behavior of cookies. 
        &quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s1">val</span><span class="s3">, </span><span class="s1">val</span>

    <span class="s3">def </span><span class="s1">value_encode(self</span><span class="s3">, </span><span class="s1">val):</span>
        <span class="s2">&quot;&quot;&quot;real_value, coded_value = value_encode(VALUE) 
        Called prior to setting a cookie's value from the dictionary 
        representation.  The VALUE is the value being assigned. 
        Override this function to modify the behavior of cookies. 
        &quot;&quot;&quot;</span>
        <span class="s1">strval = str(val)</span>
        <span class="s3">return </span><span class="s1">strval</span><span class="s3">, </span><span class="s1">strval</span>

    <span class="s3">def </span><span class="s1">__init__(self</span><span class="s3">, </span><span class="s1">input=</span><span class="s3">None</span><span class="s1">):</span>
        <span class="s3">if </span><span class="s1">input:</span>
            <span class="s1">self.load(input)</span>

    <span class="s3">def </span><span class="s1">__set(self</span><span class="s3">, </span><span class="s1">key</span><span class="s3">, </span><span class="s1">real_value</span><span class="s3">, </span><span class="s1">coded_value):</span>
        <span class="s2">&quot;&quot;&quot;Private method for setting a cookie's value&quot;&quot;&quot;</span>
        <span class="s1">M = self.get(key</span><span class="s3">, </span><span class="s1">Morsel())</span>
        <span class="s1">M.set(key</span><span class="s3">, </span><span class="s1">real_value</span><span class="s3">, </span><span class="s1">coded_value)</span>
        <span class="s1">dict.__setitem__(self</span><span class="s3">, </span><span class="s1">key</span><span class="s3">, </span><span class="s1">M)</span>

    <span class="s3">def </span><span class="s1">__setitem__(self</span><span class="s3">, </span><span class="s1">key</span><span class="s3">, </span><span class="s1">value):</span>
        <span class="s2">&quot;&quot;&quot;Dictionary style assignment.&quot;&quot;&quot;</span>
        <span class="s1">rval</span><span class="s3">, </span><span class="s1">cval = self.value_encode(value)</span>
        <span class="s1">self.__set(key</span><span class="s3">, </span><span class="s1">rval</span><span class="s3">, </span><span class="s1">cval)</span>

    <span class="s3">def </span><span class="s1">output(self</span><span class="s3">, </span><span class="s1">attrs=</span><span class="s3">None, </span><span class="s1">header=</span><span class="s5">&quot;Set-Cookie:&quot;</span><span class="s3">, </span><span class="s1">sep=</span><span class="s5">&quot;</span><span class="s3">\015\012</span><span class="s5">&quot;</span><span class="s1">):</span>
        <span class="s2">&quot;&quot;&quot;Return a string suitable for HTTP.&quot;&quot;&quot;</span>
        <span class="s1">result = []</span>
        <span class="s1">items = sorted(self.items())</span>
        <span class="s3">for </span><span class="s1">key</span><span class="s3">, </span><span class="s1">value </span><span class="s3">in </span><span class="s1">items:</span>
            <span class="s1">result.append(value.output(attrs</span><span class="s3">, </span><span class="s1">header))</span>
        <span class="s3">return </span><span class="s1">sep.join(result)</span>

    <span class="s1">__str__ = output</span>

    <span class="s1">@as_native_str()</span>
    <span class="s3">def </span><span class="s1">__repr__(self):</span>
        <span class="s1">l = []</span>
        <span class="s1">items = sorted(self.items())</span>
        <span class="s3">for </span><span class="s1">key</span><span class="s3">, </span><span class="s1">value </span><span class="s3">in </span><span class="s1">items:</span>
            <span class="s3">if </span><span class="s1">PY2 </span><span class="s3">and </span><span class="s1">isinstance(value.value</span><span class="s3">, </span><span class="s1">unicode):</span>
                <span class="s1">val = str(value.value)    </span><span class="s0"># make it a newstr to remove the u prefix</span>
            <span class="s3">else</span><span class="s1">:</span>
                <span class="s1">val = value.value</span>
            <span class="s1">l.append(</span><span class="s5">'%s=%s' </span><span class="s1">% (str(key)</span><span class="s3">, </span><span class="s1">repr(val)))</span>
        <span class="s3">return </span><span class="s5">'&lt;%s: %s&gt;' </span><span class="s1">% (self.__class__.__name__</span><span class="s3">, </span><span class="s1">_spacejoin(l))</span>

    <span class="s3">def </span><span class="s1">js_output(self</span><span class="s3">, </span><span class="s1">attrs=</span><span class="s3">None</span><span class="s1">):</span>
        <span class="s2">&quot;&quot;&quot;Return a string suitable for JavaScript.&quot;&quot;&quot;</span>
        <span class="s1">result = []</span>
        <span class="s1">items = sorted(self.items())</span>
        <span class="s3">for </span><span class="s1">key</span><span class="s3">, </span><span class="s1">value </span><span class="s3">in </span><span class="s1">items:</span>
            <span class="s1">result.append(value.js_output(attrs))</span>
        <span class="s3">return </span><span class="s1">_nulljoin(result)</span>

    <span class="s3">def </span><span class="s1">load(self</span><span class="s3">, </span><span class="s1">rawdata):</span>
        <span class="s2">&quot;&quot;&quot;Load cookies from a string (presumably HTTP_COOKIE) or 
        from a dictionary.  Loading cookies from a dictionary 'd' 
        is equivalent to calling: 
            map(Cookie.__setitem__, d.keys(), d.values()) 
        &quot;&quot;&quot;</span>
        <span class="s3">if </span><span class="s1">isinstance(rawdata</span><span class="s3">, </span><span class="s1">str):</span>
            <span class="s1">self.__parse_string(rawdata)</span>
        <span class="s3">else</span><span class="s1">:</span>
            <span class="s0"># self.update() wouldn't call our custom __setitem__</span>
            <span class="s3">for </span><span class="s1">key</span><span class="s3">, </span><span class="s1">value </span><span class="s3">in </span><span class="s1">rawdata.items():</span>
                <span class="s1">self[key] = value</span>
        <span class="s3">return</span>

    <span class="s3">def </span><span class="s1">__parse_string(self</span><span class="s3">, </span><span class="s1">mystr</span><span class="s3">, </span><span class="s1">patt=_CookiePattern):</span>
        <span class="s1">i = </span><span class="s4">0            </span><span class="s0"># Our starting point</span>
        <span class="s1">n = len(mystr)     </span><span class="s0"># Length of string</span>
        <span class="s1">M = </span><span class="s3">None         </span><span class="s0"># current morsel</span>

        <span class="s3">while </span><span class="s4">0 </span><span class="s1">&lt;= i &lt; n:</span>
            <span class="s0"># Start looking for a cookie</span>
            <span class="s1">match = patt.search(mystr</span><span class="s3">, </span><span class="s1">i)</span>
            <span class="s3">if not </span><span class="s1">match:</span>
                <span class="s0"># No more cookies</span>
                <span class="s3">break</span>

            <span class="s1">key</span><span class="s3">, </span><span class="s1">value = match.group(</span><span class="s5">&quot;key&quot;</span><span class="s1">)</span><span class="s3">, </span><span class="s1">match.group(</span><span class="s5">&quot;val&quot;</span><span class="s1">)</span>

            <span class="s1">i = match.end(</span><span class="s4">0</span><span class="s1">)</span>

            <span class="s0"># Parse the key, value in case it's metainfo</span>
            <span class="s3">if </span><span class="s1">key[</span><span class="s4">0</span><span class="s1">] == </span><span class="s5">&quot;$&quot;</span><span class="s1">:</span>
                <span class="s0"># We ignore attributes which pertain to the cookie</span>
                <span class="s0"># mechanism as a whole.  See RFC 2109.</span>
                <span class="s0"># (Does anyone care?)</span>
                <span class="s3">if </span><span class="s1">M:</span>
                    <span class="s1">M[key[</span><span class="s4">1</span><span class="s1">:]] = value</span>
            <span class="s3">elif </span><span class="s1">key.lower() </span><span class="s3">in </span><span class="s1">Morsel._reserved:</span>
                <span class="s3">if </span><span class="s1">M:</span>
                    <span class="s3">if </span><span class="s1">value </span><span class="s3">is None</span><span class="s1">:</span>
                        <span class="s3">if </span><span class="s1">key.lower() </span><span class="s3">in </span><span class="s1">Morsel._flags:</span>
                            <span class="s1">M[key] = </span><span class="s3">True</span>
                    <span class="s3">else</span><span class="s1">:</span>
                        <span class="s1">M[key] = _unquote(value)</span>
            <span class="s3">elif </span><span class="s1">value </span><span class="s3">is not None</span><span class="s1">:</span>
                <span class="s1">rval</span><span class="s3">, </span><span class="s1">cval = self.value_decode(value)</span>
                <span class="s1">self.__set(key</span><span class="s3">, </span><span class="s1">rval</span><span class="s3">, </span><span class="s1">cval)</span>
                <span class="s1">M = self[key]</span>


<span class="s3">class </span><span class="s1">SimpleCookie(BaseCookie):</span>
    <span class="s2">&quot;&quot;&quot; 
    SimpleCookie supports strings as cookie values.  When setting 
    the value using the dictionary assignment notation, SimpleCookie 
    calls the builtin str() to convert the value to a string.  Values 
    received from HTTP are kept as strings. 
    &quot;&quot;&quot;</span>
    <span class="s3">def </span><span class="s1">value_decode(self</span><span class="s3">, </span><span class="s1">val):</span>
        <span class="s3">return </span><span class="s1">_unquote(val)</span><span class="s3">, </span><span class="s1">val</span>

    <span class="s3">def </span><span class="s1">value_encode(self</span><span class="s3">, </span><span class="s1">val):</span>
        <span class="s1">strval = str(val)</span>
        <span class="s3">return </span><span class="s1">strval</span><span class="s3">, </span><span class="s1">_quote(strval)</span>
</pre>
</body>
</html>